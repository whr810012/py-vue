# 社区志愿服务系统启动指南

## 项目概述
npm run start:dev
这是一个基于 Vue.js + Flask 的社区志愿服务系统，包含前端用户界面和后端API服务。

## 系统要求

- **Python**: 3.7+
- **Node.js**: 14+
- **npm**: 6+

## 项目结构

```
py-vue/
├── backend/           # Flask后端服务
│   ├── app/
│   │   ├── models/    # 数据模型
│   │   └── routes/    # API路由
│   ├── requirements.txt
│   └── run.py
└── frontend/          # Vue前端应用
    ├── src/
    ├── package.json
    └── vue.config.js
```

## 后端启动步骤

### 1. 进入后端目录
```bash
cd backend
```

### 2. 创建虚拟环境（推荐）
```bash
# Windows
python -m venv venv
venv\Scripts\activate

# macOS/Linux
python3 -m venv venv
source venv/bin/activate
```

### 3. 安装依赖
```bash
pip install -r requirements.txt
```

或者手动安装主要依赖：
```bash
pip install Flask==2.3.3 Flask-SQLAlchemy==3.0.5 Flask-JWT-Extended==4.5.3 Flask-CORS==4.0.0
```

### 4. 启动后端服务
```bash
python run.py
```

### 5. 验证后端服务
后端服务将在以下地址启动：
- **本地访问**: http://127.0.0.1:5000
- **网络访问**: http://192.168.x.x:5000

你应该看到类似以下的输出：
```
 * Serving Flask app 'app'
 * Debug mode: on
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.60.30:5000
```

## 前端启动步骤

### 1. 进入前端目录
```bash
cd frontend
```

### 2. 安装依赖
```bash
npm install
```

### 3. 启动开发服务器
```bash
npm run serve
```

### 4. 验证前端服务
前端服务将在以下地址启动：
- **本地访问**: http://localhost:8080 或 http://localhost:8081
- **网络访问**: http://192.168.x.x:8080

你应该看到类似以下的输出：
```
  App running at:
  - Local:   http://localhost:8081/
  - Network: http://192.168.60.30:8081/
```

## 完整启动流程

### 方法一：一键启动脚本（推荐）

我们提供了多种一键启动脚本，选择适合你系统的方式：

#### Windows系统
```bash
# 双击运行或在命令行执行
start.bat
```

#### macOS/Linux系统
```bash
# 给脚本执行权限
chmod +x start.sh

# 运行脚本
./start.sh
```

#### 跨平台Node.js脚本
```bash
# 首次使用需要安装依赖
npm install

# 启动服务
npm start
# 或者
node start.js
```

#### 使用concurrently（开发推荐）
```bash
# 安装依赖（首次）
npm install

# 同时启动前后端
npm run start:dev
```

### 方法二：分别启动（调试时使用）

1. **启动后端**（终端1）：
   ```bash
   cd backend
   python run.py
   ```

2. **启动前端**（终端2）：
   ```bash
   cd frontend
   npm run serve
   ```

### 方法三：单独启动某个服务

```bash
# 只启动后端
npm run start:backend

# 只启动前端
npm run start:frontend
```

## 访问系统

启动成功后，在浏览器中访问：
**http://localhost:8081**

## 系统功能

- **用户注册/登录**
- **浏览志愿活动**
- **报名参加活动**
- **创建志愿活动**
- **个人中心管理**
- **活动统计数据**

## 默认端口

- **后端API**: 5000
- **前端应用**: 8080/8081
- **数据库**: SQLite（本地文件）

## 可用的npm脚本命令

在项目根目录下，我们提供了以下npm脚本命令：

```bash
# 一键启动前后端（Node.js脚本）
npm start

# 使用concurrently同时启动前后端
npm run start:dev

# 只启动后端服务
npm run start:backend

# 只启动前端服务
npm run start:frontend

# 构建前端生产版本
npm run build

# 安装所有依赖（前端+后端）
npm run install:all

# 清理缓存和构建文件
npm run clean
```

### 首次使用建议

1. **安装所有依赖**：
   ```bash
   npm run install:all
   ```

2. **启动开发服务**：
   ```bash
   npm run start:dev
   ```

## 常见问题

### 1. 端口被占用
如果端口被占用，可以修改配置：

**后端端口修改**：
编辑 `backend/run.py`：
```python
app.run(host='0.0.0.0', port=5001, debug=True)  # 改为5001
```

**前端端口修改**：
编辑 `frontend/vue.config.js`：
```javascript
module.exports = {
  devServer: {
    port: 8082  // 改为8082
  }
}
```

### 2. 依赖安装失败

**Python依赖问题**：
```bash
# 升级pip
pip install --upgrade pip

# 清除缓存
pip cache purge
```

**Node.js依赖问题**：
```bash
# 清除缓存
npm cache clean --force

# 删除node_modules重新安装
rm -rf node_modules
npm install
```

### 3. 跨域问题
前端已配置代理，API请求会自动转发到后端。如果遇到跨域问题，检查：

1. 后端是否启动在5000端口
2. 前端 `vue.config.js` 中的代理配置
3. 后端 Flask-CORS 配置

## 开发建议

1. **开发环境**：使用两个终端分别启动前后端
2. **调试模式**：后端默认开启debug模式，前端有热重载
3. **数据库**：开发环境使用SQLite，生产环境建议使用PostgreSQL或MySQL
4. **环境变量**：生产环境请配置相应的环境变量

## 生产部署

### 前端构建
```bash
cd frontend
npm run build
```

### 后端生产配置
```bash
# 安装生产服务器
pip install gunicorn

# 启动生产服务
gunicorn -w 4 -b 0.0.0.0:5000 run:app
```

---

**注意**：首次启动时，系统会自动创建数据库和必要的表结构。